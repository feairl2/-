<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>PRIMAL VAULT</title>
    <style>
        :root { --bg: #000; --text: #fff; }
        body { background: var(--bg); color: var(--text); font-family: "Inter", sans-serif; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .wrapper { width: 100%; max-width: 600px; padding: 40px; border: 1px solid #111; background: #050505; text-align: center; }
        h1 { font-weight: 100; letter-spacing: 12px; text-transform: uppercase; font-size: 18px; margin-bottom: 30px; }
        textarea { width: 100%; height: 180px; background: transparent; border: 1px solid #222; color: #fff; padding: 15px; outline: none; font-size: 12px; font-family: monospace; }
        .btn { background: #fff; color: #000; border: none; padding: 15px 40px; font-size: 10px; font-weight: 800; letter-spacing: 2px; cursor: pointer; text-transform: uppercase; margin-top: 25px; }
        #out { margin-top: 25px; height: 100px; color: #444; border-color: #111; display: none; }
    </style>
</head>
<body>

<div class="wrapper">
    <h1>Primal Vault</h1>
    <textarea id="src" placeholder="貼入 HTML 代碼..."></textarea>
    <button class="btn" onclick="build()">Generate Secure File</button>
    <textarea id="out" readonly onclick="this.select(); document.execCommand('copy');"></textarea>
</div>

<script>
async function build() {
    const raw = document.getElementById('src').value;
    if(!raw) return;

    const encoder = new TextEncoder();
    const data = encoder.encode(raw);
    const key = await window.crypto.subtle.generateKey({ name: "AES-GCM", length: 256 }, true, ["encrypt", "decrypt"]);
    const iv = window.crypto.getRandomValues(new Uint8Array(12));
    const encrypted = await window.crypto.subtle.encrypt({ name: "AES-GCM", iv: iv }, key, data);

    const b2h = b => Array.from(new Uint8Array(b)).map(x => x.toString(16).padStart(2, '0')).join('');
    const kH = b2h(await window.crypto.subtle.exportKey("raw", key));
    const iH = b2h(iv);
    const dH = b2h(encrypted);

    document.getElementById('out').value = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script>
    (function() {
        let auth = false;
        document.addEventListener('mousedown', () => auth = true, {once:true});

        const punish = () => {
            if(auth) {
                for(let i=0; i<3; i++) window.open('https://www.youtube.com', '_blank');
            }
            location.href = "about:blank";
        };

        // 快捷鍵攔截
        window.addEventListener('keydown', (e) => {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key)) || (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                punish();
            }
        }, true);

        // 偵測 F12 視窗變動
        setInterval(() => {
            if(window.outerWidth - window.innerWidth > 160 || window.outerHeight - window.innerHeight > 160) punish();
        }, 500);

        // Debugger 與右鍵禁用
        setInterval(() => { (function(){}).constructor("debugger")(); }, 50);
        document.oncontextmenu = () => false;

        // 瞬發解密 (不顯示加載動畫)
        const h2b = h => new Uint8Array(h.match(/.{1,2}/g).map(b => parseInt(b, 16)));
        window.onload = async () => {
            try {
                const k = await window.crypto.subtle.importKey("raw", h2b("${kH}"), "AES-GCM", true, ["decrypt"]);
                const d = await window.crypto.subtle.decrypt({ name: "AES-GCM", iv: h2b("${iH}") }, k, h2b("${dH}"));
                document.open(); 
                document.write(new TextDecoder().decode(d)); 
                document.close();
            } catch(e) { document.body.innerHTML = "Access Denied"; }
        };
    })();
    <\/script>
</head>
<body style="background:#000;"></body>
</html>`;
    document.getElementById('out').style.display = 'block';
}
</script>
</body>
</html>
