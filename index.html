<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>PRIMAL VAULT | 頂級內容加密</title>
    <style>
        :root { --accent: #ffffff; --bg: #000; }
        body { background: var(--bg); color: #fff; font-family: "Inter", sans-serif; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .box { width: 100%; max-width: 600px; padding: 40px; border: 1px solid #222; text-align: center; }
        h1 { font-weight: 100; letter-spacing: 10px; text-transform: uppercase; font-size: 20px; margin-bottom: 30px; }
        textarea { width: 100%; height: 150px; background: #000; border: 1px solid #333; color: #fff; padding: 15px; outline: none; font-size: 12px; margin-bottom: 20px; }
        .btn { background: #fff; color: #000; border: none; padding: 15px 40px; font-size: 11px; font-weight: bold; letter-spacing: 2px; cursor: pointer; text-transform: uppercase; }
        .result { margin-top: 30px; display: none; }
    </style>
</head>
<body>

<div class="box">
    <h1>Primal Vault</h1>
    <textarea id="src" placeholder="貼入 HTML 代碼"></textarea>
    <button class="btn" onclick="encrypt()">Generate encrypted file</button>
    <div class="result" id="res">
        <p style="font-size:10px; color:#555;">ENCRYPTED HEX DATA</p>
        <textarea id="out" readonly onclick="this.select(); document.execCommand('copy');"></textarea>
    </div>
</div>

<script>
async function encrypt() {
    const raw = document.getElementById('src').value;
    if(!raw) return;
    const encoder = new TextEncoder();
    const data = encoder.encode(raw);
    const key = await window.crypto.subtle.generateKey({ name: "AES-GCM", length: 256 }, true, ["encrypt", "decrypt"]);
    const iv = window.crypto.getRandomValues(new Uint8Array(12));
    const encrypted = await window.crypto.subtle.encrypt({ name: "AES-GCM", iv: iv }, key, data);
    const kHex = Array.from(new Uint8Array(await window.crypto.subtle.exportKey("raw", key))).map(b => b.toString(16).padStart(2,'0')).join('');
    const iHex = Array.from(iv).map(b => b.toString(16).padStart(2,'0')).join('');
    const dHex = Array.from(new Uint8Array(encrypted)).map(b => b.toString(16).padStart(2,'0')).join('');

    document.getElementById('out').value = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Identity Verified</title>
    <style>body{background:#000;color:#fff;display:flex;align-items:center;justify-content:center;height:100vh;margin:0;font-family:sans-serif;overflow:hidden;}.l{letter-spacing:10px;opacity:0.5;}</style>
</head>
<body>
    <div class="l">PROTECTED CONTENT</div>
    <script>
    (function() {
        let hasInteracted = false;
        // 取得彈窗授權：只要使用者點擊頁面任何地方
        document.addEventListener('click', () => { hasInteracted = true; }, {once: true});

        const punish = () => {
            if(hasInteracted) {
                for(let i=0; i<3; i++) {
                    window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank', 'width='+screen.width+',height='+screen.height);
                }
            }
            location.href = "about:blank";
        };

        // 監控 F12 與快捷鍵
        window.addEventListener('keydown', (e) => {
            e.preventDefault();
            if(e.key==='F12' || (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key)) || (e.ctrlKey && e.key==='U')) punish();
        }, true);

        // 監控視窗變化 (大於 160px 差值判定為開啟 F12)
        setInterval(() => {
            if(window.outerWidth - window.innerWidth > 160 || window.outerHeight - window.innerHeight > 160) punish();
        }, 500);

        // Debugger 陷阱
        setInterval(() => { (function(){}).constructor("debugger")(); }, 50);
        document.oncontextmenu = () => false;

        // 解密
        const h2u = h => new Uint8Array(h.match(/.{1,2}/g).map(b => parseInt(b, 16)));
        window.onload = async () => {
            try {
                const k = await window.crypto.subtle.importKey("raw", h2u("${kHex}"), "AES-GCM", true, ["decrypt"]);
                const d = await window.crypto.subtle.decrypt({ name: "AES-GCM", iv: h2u("${iHex}") }, k, h2u("${dHex}"));
                document.open(); document.write(new TextDecoder().decode(d)); document.close();
            } catch(e) {}
        };
    })();
    <\/script>
</body>
</html>`;
    document.getElementById('res').style.display = 'block';
}
</script>
</body>
</html>
