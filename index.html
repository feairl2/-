<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCRYPT // SILENT_DEPLOY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #080808; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
        .bento { background: #0d0d0d; border: 1px solid #1a1a1a; box-shadow: inset 0 1px 1px rgba(255,255,255,0.02); }
        textarea { resize: none; color: #888; transition: color 0.3s; }
        textarea:focus { color: #fff; outline: none; }
        .copy-trigger { cursor: pointer; transition: all 0.2s; }
        .copy-trigger:active { transform: translateY(2px); filter: brightness(1.2); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-8">

    <div class="w-full max-w-5xl">
        <div class="flex items-center gap-3 mb-8">
            <div class="w-3 h-3 bg-white rounded-full"></div>
            <h1 class="text-white font-bold tracking-widest text-sm">ENCRYPTED_DEPLOYMENT_TOOL</h1>
        </div>

        <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-9 bento rounded-xl p-1">
                <textarea id="raw" placeholder="// DROP YOUR HTML CODE HERE..." class="w-full h-[500px] p-6 bg-transparent text-sm leading-relaxed"></textarea>
            </div>

            <div class="col-span-12 lg:col-span-3 space-y-6">
                <div class="bento rounded-xl p-6">
                    <div class="text-[10px] text-zinc-600 mb-4 tracking-widest uppercase">Protocol</div>
                    <p class="text-xs text-zinc-400 leading-relaxed">
                        原生 WebCrypto AES-GCM 模式。密鑰將被切片並自動注入。解碼過程對用戶透明。
                    </p>
                </div>

                <div onclick="generateAndCopy()" class="copy-trigger bg-white rounded-xl p-6 flex flex-col items-center justify-center text-black">
                    <span class="text-[10px] font-bold tracking-widest uppercase mb-1">Execute</span>
                    <span class="font-bold">加密並複製代碼</span>
                </div>

                <div id="log" class="text-[10px] text-zinc-700 font-mono break-all leading-tight">
                    SYSTEM_READY...<br>AWAITING_INPUT
                </div>
            </div>
        </div>
    </div>

    <script>
        async function generateAndCopy() {
            const content = document.getElementById('raw').value;
            const log = document.getElementById('log');
            if (!content) return;

            try {
                const enc = new TextEncoder();
                const key = await crypto.subtle.generateKey({name: "AES-GCM", length: 256}, true, ["encrypt", "decrypt"]);
                const iv = crypto.getRandomValues(new Uint8Array(12));
                const encrypted = await crypto.subtle.encrypt({name: "AES-GCM", iv}, key, enc.encode(content));
                const exportedKey = await crypto.subtle.exportKey("raw", key);

                const data = {
                    i: btoa(String.fromCharCode(...iv)),
                    k: btoa(String.fromCharCode(...new Uint8Array(exportedKey))),
                    d: btoa(String.fromCharCode(...new Uint8Array(encrypted)))
                };

                const template = `<!DOCTYPE html><html><head><meta charset="UTF-8"></head><body><script>const _0x= ${JSON.stringify(data)};(async()=>{const k=Uint8Array.from(atob(_0x.k),c=>c.charCodeAt(0)),v=Uint8Array.from(atob(_0x.i),c=>c.charCodeAt(0)),d=Uint8Array.from(atob(_0x.d),c=>c.charCodeAt(0)),sk=await crypto.subtle.importKey("raw",k,"AES-GCM",false,["decrypt"]),dec=await crypto.subtle.decrypt({name:"AES-GCM",iv:v},sk,d);document.open();document.write(new TextDecoder().decode(dec));document.close()})()<\/script></body></html>`;

                await navigator.clipboard.writeText(template);
                log.innerHTML = "STATUS_SUCCESS<br>PAYLOAD_COPIED_TO_CLIPBOARD<br>TIMESTAMP: " + Date.now();
                log.style.color = "#fff";
            } catch (err) {
                log.innerText = "CRITICAL_ERROR: " + err.message;
                log.style.color = "#ff0000";
            }
        }
    </script>
</body>
</html>
