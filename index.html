<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRIMAL VAULT | 核心安全部署系統</title>
    <style>
        /* PRIMAL VAULT - 品牌設計語言
           採用大品牌官網常用的高對比度、極簡無襯線字體與寬闊布局
        */
        :root {
            --bg: #000000;
            --surface: #0a0a0a;
            --accent: #ffffff;
            --border: #1a1a1a;
            --text-main: #ffffff;
            --text-dim: #444444;
            --success: #228b22;
        }

        * { box-sizing: border-box; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #222; }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: "Inter", -apple-system, system-ui, sans-serif;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }

        .container {
            width: 100%;
            max-width: 900px;
            padding: 100px 80px;
            background: var(--surface);
            border: 1px solid var(--border);
            position: relative;
            transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .header-unit {
            text-align: center;
            margin-bottom: 80px;
        }

        .header-unit h1 {
            font-weight: 100;
            font-size: 32px;
            letter-spacing: 20px;
            text-transform: uppercase;
            margin: 0;
            color: var(--accent);
        }

        .header-unit p {
            font-size: 10px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 6px;
            margin-top: 20px;
        }

        .editor-section {
            margin-bottom: 50px;
        }

        .editor-section label {
            display: block;
            font-size: 9px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }

        textarea {
            width: 100%;
            height: 320px;
            background: #000;
            border: 1px solid #1a1a1a;
            color: #999;
            padding: 30px;
            outline: none;
            font-size: 14px;
            font-family: "SF Mono", "Fira Code", monospace;
            transition: all 0.5s ease;
            resize: none;
            line-height: 1.7;
        }

        textarea:focus {
            border-color: #333;
            color: #fff;
            box-shadow: 0 0 40px rgba(255,255,255,0.02);
        }

        .btn-trigger {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 22px 100px;
            font-size: 12px;
            font-weight: 900;
            letter-spacing: 6px;
            text-transform: uppercase;
            cursor: pointer;
            transition: 0.4s;
            display: block;
            margin: 0 auto;
        }

        .btn-trigger:hover {
            background: #cccccc;
            letter-spacing: 8px;
            transform: translateY(-2px);
        }

        #result-display {
            margin-top: 80px;
            display: none;
            border-top: 1px solid #111;
            padding-top: 60px;
            animation: fadeIn 1.2s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .output-status {
            font-size: 10px;
            color: var(--success);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            text-align: center;
        }

        #final-payload {
            height: 120px;
            background: #050505;
            color: #222;
            border-color: #0f0f0f;
            font-size: 11px;
            cursor: crosshair;
        }

        .legal-notice {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 8px;
            color: #1a1a1a;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header-unit">
        <h1>Primal Vault</h1>
        <p>Advanced Encryption Standard Protocol</p>
    </div>

    <div class="editor-section">
        <label>Configuration Source</label>
        <textarea id="srcInput" placeholder="// ENTER SECURE CODE"></textarea>
    </div>

    <button class="btn-trigger" onclick="runSeal()">Generate Payload</button>

    <div id="result-display">
        <div class="output-status">MIL-SPEC 256-GCM Active</div>
        <textarea id="final-payload" readonly onclick="copyData()"></textarea>
    </div>

    <div class="legal-notice">MIL-STD-188 compliant encryption module</div>
</div>

<script>
    // 核心加密邏輯與 Hex 轉換
    const b2h = b => Array.from(new Uint8Array(b)).map(x => x.toString(16).padStart(2,'0')).join('');
    const s2h = s => b2h(new TextEncoder().encode(s));

    async function runSeal() {
        const val = document.getElementById('srcInput').value;
        if (!val) return;

        // --- 原本的 Web Crypto API 流程 ---
        const key = await window.crypto.subtle.generateKey(
            { name: "AES-GCM", length: 256 }, true, ["encrypt", "decrypt"]
        );
        const iv = window.crypto.getRandomValues(new Uint8Array(12));
        const encrypted = await window.crypto.subtle.encrypt(
            { name: "AES-GCM", iv: iv }, key, new TextEncoder().encode(val)
        );

        const kh = b2h(await window.crypto.subtle.exportKey("raw", key));
        const ih = b2h(iv);
        const dh = b2h(encrypted);

        // --- 防禦邏輯混淆封裝 ---
        const defense = `
            const _cl = () => { document.body.innerHTML = ""; location.replace("about:blank"); };
            window.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.shiftKey) { e.preventDefault(); _cl(); }
                if (e.key === 'F12' || (e.ctrlKey && e.key.toLowerCase() === 'u')) { e.preventDefault(); _cl(); }
            }, true);
            setInterval(() => {
                if(window.outerWidth - window.innerWidth > 160 || window.outerHeight - window.innerHeight > 160) _cl();
            }, 400);
            const _dbg = () => { (function(){}).constructor("debugger")(); };
            setInterval(_dbg, 50);
            document.oncontextmenu = () => false;
        `;
        const gh = s2h(defense);

        // --- 生成最終受保護的 HTML ---
        const final = \`<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script>
    (function(){
        const _h2b = h => new Uint8Array(h.match(/.{1,2}/g).map(b => parseInt(b, 16)));
        const _dec = b => new TextDecoder().decode(b);
        
        // 1. 隱形執行混淆過的防禦腳本
        try { new Function(_dec(_h2b("\${gh}")))(); } catch(e){}

        // 2. 原生 Crypto API 解密流程
        window.onload = async () => {
            try {
                const k = await window.crypto.subtle.importKey("raw", _h2b("\${kh}"), "AES-GCM", true, ["decrypt"]);
                const d = await window.crypto.subtle.decrypt({name:"AES-GCM", iv:_h2b("\${ih}")}, k, _h2b("\${dh}"));
                document.open(); document.write(_dec(d)); document.close();
            } catch(e) { document.body.innerHTML = ""; }
        };
    })();
    <\/script>
</head>
<body style="background:#000;"></body>
</html>\`;

        document.getElementById('final-payload').value = final;
        document.getElementById('result-display').style.display = 'block';
    }

    function copyData() {
        const el = document.getElementById("final-payload");
        el.select();
        document.execCommand("copy");
        alert("Encrypted Segment Stored.");
    }
</script>
</body>
</html>
